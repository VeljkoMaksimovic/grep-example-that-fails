version: v1.0
name: Semaphore Go CI example
agent:
  machine:
    type: s1-vm-macOS
    os_image: ''
blocks:
  - name: Build project
    task:
      jobs:
        - commands:
            - echo "test22"
          env_vars:
            - name: TESTS_TO_RUN
              value: TestPrivateLinkAwsE2E/TestPrivateAwsClientWorkflow
          name: test
promotions:
  - name: Promotion 1
    pipeline_file: pipeline_3.yml
    parameters:
      env_vars:
        - name: CANARY_NAME
          required: true
          default_value: aleks
          description: Canary to deploy to
          options:
            - "aleks"
            - "igor"
            - "nick"
            - "radwo"
            - "ropsi"
            - "ralopes"
            - "amir"
            - "veljko"
            - "mattrym"
    auto_promote:
      when: branch = 'master' AND result = 'passed'
